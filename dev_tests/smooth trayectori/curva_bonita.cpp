#include <vector>
#include <iostream>

#include <opencv2/opencv.hpp>
#include <cmath>
#include <chrono>

struct Punto
{
    float x;
    float y;
};

// ----- Paso 1: Suavizado Savitzky–Golay -----
std::vector<Punto> savGolay(const std::vector<Punto> &in, int window_size, int poly_order)
{
    // Implementa aquí la convolución con coeficientes SG
    // O usa una librería existente
    return in; // placeholder
}

// ----- Paso 2: Simplificación RDP -----
double puntoLineaDist(const Punto &p, const Punto &a, const Punto &b)
{
    double ux = b.x - a.x, uy = b.y - a.y;
    double vx = p.x - a.x, vy = p.y - a.y;
    double area = std::abs(ux * vy - uy * vx);
    double len = std::hypot(ux, uy);
    return area / len;
}

std::vector<Punto> rdp(const std::vector<Punto> &pts, double eps)
{
    if (pts.size() < 3)
        return pts;
    // Encuentra punto más lejano de la línea
    size_t idx = 0;
    double dmax = 0;
    for (size_t i = 1; i + 1 < pts.size(); ++i)
    {
        double d = puntoLineaDist(pts[i], pts.front(), pts.back());
        if (d > dmax)
        {
            idx = i;
            dmax = d;
        }
    }
    if (dmax < eps)
    {
        return {pts.front(), pts.back()};
    }
    // Recursión
    auto left = rdp({pts.begin(), pts.begin() + idx + 1}, eps);
    auto right = rdp({pts.begin() + idx, pts.end()}, eps);
    left.pop_back();
    left.insert(left.end(), right.begin(), right.end());
    return left;
}

// Función para dibujar una trayectoria con un color específico
void dibujarTrayectoria(cv::Mat &imagen, const std::vector<Punto> &puntos, cv::Scalar color, int grosor)
{
    for (size_t i = 1; i < puntos.size(); ++i)
    {
        cv::line(imagen, cv::Point(puntos[i - 1].x * 5, 500 - puntos[i - 1].y * 5),
                 cv::Point(puntos[i].x * 5, 500 - puntos[i].y * 5), color, grosor);
    }
}

int main()
{
    // std::vector<Punto> puntosOriginales = {
    //     {75, 12}, {71, 13}, {67, 13}, {66, 14},
    //     {53, 20}, {51, 21}, {48, 24}, {48, 24},
    //     {33, 36}, {32, 37}, {31, 39}, {31, 39},
    //     {29, 46}, {29, 48}, {29, 51}, {29, 52},
    //     {35, 77}, {36, 80}, {38, 84}, {38, 85},
    //     {40, 91}, {41, 92}, {43, 93}, {44, 93},
    //     {75, 94}, {77, 94}, {79, 94}, {79, 94},
    //     {85, 91}, {87, 91}, {89, 89}, {91, 89},
    //     {100, 83},{102, 81}, {103, 80}, {103, 80},
    //     {103, 61},
    // };
    // std::vector<Punto> puntosOriginales = {
    //     {98, 42}, {97, 36}, {97, 34}, {97, 33}, {97, 32}, {97, 31}, {96, 30}, {96, 28}, {85, 25}, {85, 25}, {84, 25}, {82, 25}, {81, 25}, {77, 26}, {70, 27}, {68, 27}, {67, 28}, {65, 28}, {63, 28}, {57, 29}, {53, 29}, {53, 29}, {52, 29}, {51, 29}, {50, 29}, {46, 29}, {43, 29}, {42, 29}, {41, 29}, {40, 29}, {39, 29}, {36, 29}, {33, 29}, {33, 30}, {33, 31}, {33, 33}, {33, 34}, {33, 39}, {33, 42}, {33, 44}, {33, 45}, {32, 47}, {32, 48}, {32, 52}, {32, 57}, {32, 58}, {32, 59}, {32, 61}, {32, 62}, {32, 66}, {32, 72}, {32, 73}, {32, 75}, {33, 77}, {33, 78}, {33, 81}, {33, 84}, {33, 85}, {34, 85}, {35, 87}, {36, 87}, {38, 88}, {40, 89}, {41, 90}, {42, 90}, {43, 90}, {44, 90}, {46, 91}, {50, 91}, {51, 90}, {52, 90}, {53, 90}, {54, 90}, {58, 89}, {60, 89}, {61, 89}, {62, 89}, {63, 89}, {64, 90}, {68, 90}, {73, 90}, {74, 90}, {75, 90}, {77, 90}, {79, 90}, {84, 89}, {88, 89}, {89, 89}, {91, 89}, {92, 90}, {93, 90}, {98, 77}, {98, 73}, {98, 71}, {98, 71}, {96, 71}, {96, 71}, {92, 70}, {89, 70}, {88, 70}, {87, 70}, {84, 70}, {83, 70}, {77, 70}, {73, 71}, {72, 71}, {71, 71}, {70, 71}, {69, 71}, {65, 71}, {61, 71}, {60, 71}, {58, 71}, {57, 71}, {56, 71}, {53, 71}, {53, 69}, {53, 67}, {53, 66}, {53, 64}, {53, 62}, {53, 58}, {53, 54}, {53, 53}, {53, 52}, {53, 52}, {53, 51}, {54, 49}, {57, 49}, {58, 50}, {59, 50}, {60, 50}, {61, 50}, {65, 50}, {69, 50}, {70, 50}, {72, 49}, {74, 49}, {75, 49}, {79, 48}, {83, 48}, {87, 48}};

        std::vector<Punto> puntosOriginales = {
            {98, 42}, {98, 42}, {98, 41}, {98, 41}, {98, 40}, {97, 40}, {97, 40}, {97, 39}, {97, 39}, {97, 39}, {97, 38}, {97, 38}, {97, 37}, {97, 37}, {97, 37}, {97, 36}, {97, 36}, {97, 36}, {97, 36}, {97, 35}, {97, 35}, {97, 35}, {97, 35}, {97, 35}, {97, 34}, {97, 34}, {97, 34}, {97, 34}, {97, 34}, {97, 34}, {97, 33}, {97, 33}, {97, 33}, {97, 33}, {97, 33}, {97, 33}, {97, 32}, {97, 32}, {97, 32}, {97, 32}, {97, 31}, {97, 31}, {97, 31}, {97, 31}, {96, 31}, {96, 30}, {96, 30}, {96, 30}, {96, 30}, {96, 30}, {96, 30}, {96, 29}, {96, 29}, {96, 29}, {96, 29}, {96, 28}, {96, 28}, {96, 28}, {96, 28}, {96, 28}, {96, 28}, {96, 28}, {96, 27}, {96, 27}, {96, 27}, {96, 27}, {96, 27}, {96, 27}, {96, 27}, {96, 26}, {95, 26}, {95, 26}, {95, 26}, {95, 26}, {94, 26}, {94, 26}, {94, 26}, {94, 26}, {93, 26}, {93, 26}, {93, 25}, {92, 25}, {92, 25}, {92, 25}, {92, 25}, {92, 25}, {91, 25}, {91, 25}, {91, 25}, {91, 25}, {90, 25}, {90, 25}, {90, 25}, {90, 25}, {89, 25}, {89, 25}, {89, 25}, {89, 25}, {89, 25}, {88, 25}, {88, 25}, {88, 25}, {88, 25}, {87, 25}, {87, 25}, {87, 25}, {87, 25}, {87, 25}, {86, 25}, {86, 25}, {86, 25}, {86, 25}, {85, 25}, {85, 25}, {85, 25}, {85, 25}, {85, 25}, {84, 25}, {84, 25}, {84, 25}, {84, 25}, {84, 25}, {83, 25}, {83, 25}, {83, 25}, {82, 25}, {82, 25}, {82, 25}, {81, 25}, {81, 25}, {81, 25}, {80, 25}, {80, 25}, {80, 25}, {80, 25}, {80, 25}, {79, 25}, {79, 25}, {79, 25}, {79, 26}, {79, 26}, {78, 26}, {78, 26}, {78, 26}, {77, 26}, {77, 26}, {77, 26}, {76, 26}, {76, 26}, {75, 26}, {74, 26}, {74, 26}, {74, 26}, {73, 27}, {73, 27}, {73, 27}, {72, 27}, {71, 27}, {70, 27}, {70, 27}, {69, 27}, {68, 27}, {67, 27}, {67, 28}, {67, 28}, {66, 28}, {66, 28}, {66, 28}, {65, 28}, {65, 28}, {64, 28}, {64, 28}, {63, 28}, {63, 28}, {62, 28}, {62, 28}, {61, 28}, {61, 28}, {61, 28}, {60, 28}, {60, 28}, {60, 28}, {59, 28}, {59, 28}, {59, 28}, {59, 28}, {58, 29}, {58, 29}, {57, 29}, {57, 29}, {57, 29}, {56, 29}, {56, 29}, {56, 29}, {55, 29}, {55, 29}, {55, 29}, {54, 29}, {54, 29}, {54, 29}, {54, 29}, {53, 29}, {53, 29}, {53, 29}, {53, 29}, {53, 29}, {53, 29}, {52, 29}, {52, 29}, {52, 29}, {52, 29}, {51, 29}, {51, 29}, {51, 29}, {51, 29}, {51, 29}, {50, 29}, {50, 29}, {50, 29}, {50, 29}, {50, 29}, {50, 29}, {49, 29}, {49, 29}, {49, 29}, {49, 29}, {49, 29}, {48, 29}, {48, 29}, {48, 29}, {48, 29}, {48, 29}, {47, 29}, {47, 29}, {47, 29}, {46, 29}, {46, 29}, {46, 29}, {45, 29}, {45, 29}, {45, 29}, {45, 29}, {45, 29}, {44, 29}, {44, 29}, {44, 29}, {44, 29}, {43, 29}, {43, 29}, {43, 29}, {43, 29}, {42, 29}, {42, 29}, {42, 29}, {42, 29}, {41, 29}, {41, 29}, {41, 29}, {41, 29}, {40, 29}, {40, 29}, {40, 29}, {40, 29}, {39, 29}, {39, 29}, {39, 29}, {39, 29}, {38, 29}, {38, 29}, {38, 29}, {38, 29}, {37, 29}, {37, 29}, {37, 29}, {37, 29}, {37, 29}, {36, 29}, {36, 29}, {36, 29}, {36, 29}, {35, 29}, {35, 29}, {35, 29}, {34, 29}, {34, 29}, {34, 29}, {33, 29}, {33, 29}, {33, 29}, {33, 29}, {33, 29}, {33, 30}, {33, 30}, {33, 30}, {33, 31}, {33, 31}, {33, 31}, {33, 32}, {33, 32}, {33, 32}, {33, 33}, {33, 33}, {33, 33}, {33, 34}, {33, 34}, {33, 34}, {33, 34}, {33, 35}, {33, 35}, {33, 35}, {33, 35}, {33, 35}, {33, 36}, {33, 36}, {33, 37}, {33, 37}, {33, 37}, {33, 37}, {33, 38}, {33, 38}, {33, 38}, {33, 39}, {33, 39}, {33, 39}, {33, 39}, {33, 39}, {33, 40}, {33, 40}, {33, 40}, {33, 40}, {33, 41}, {33, 41}, {33, 41}, {33, 41}, {33, 42}, {33, 42}, {33, 43}, {33, 43}, {33, 43}, {33, 44}, {33, 44}, {33, 44}, {33, 45}, {33, 45}, {33, 45}, {33, 45}, {33, 46}, {33, 46}, {32, 47}, {32, 47}, {32, 47}, {32, 48}, {32, 48}, {32, 49}, {32, 49}, {32, 49}, {32, 50}, {32, 50}, {32, 50}, {32, 50}, {32, 50}, {32, 51}, {32, 51}, {32, 51}, {32, 51}, {32, 52}, {32, 52}, {32, 52}, {32, 52}, {32, 53}, {32, 53}, {32, 54}, {32, 54}, {32, 54}, {32, 55}, {32, 55}, {32, 56}, {32, 56}, {32, 56}, {32, 56}, {32, 57}, {32, 57}, {32, 57}, {32, 57}, {32, 57}, {32, 58}, {32, 58}, {32, 58}, {32, 59}, {32, 59}, {32, 59}, {32, 59}, {32, 60}, {32, 60}, {32, 60}, {32, 61}, {32, 61}, {32, 61}, {32, 61}, {32, 62}, {32, 62}, {32, 62}, {32, 62}, {32, 63}, {32, 63}, {32, 63}, {32, 63}, {32, 63}, {32, 64}, {32, 64}, {32, 64}, {32, 65}, {32, 65}, {32, 65}, {32, 66}, {32, 66}, {32, 66}, {32, 66}, {32, 67}, {32, 67}, {32, 68}, {32, 69}, {32, 69}, {32, 70}, {32, 70}, {32, 71}, {32, 71}, {32, 72}, {32, 72}, {32, 73}, {32, 73}, {32, 73}, {32, 74}, {32, 74}, {32, 75}, {33, 75}, {33, 75}, {33, 76}, {33, 76}, {33, 77}, {33, 77}, {33, 77}, {33, 78}, {33, 78}, {33, 78}, {33, 78}, {33, 78}, {33, 78}, {33, 79}, {33, 79}, {33, 79}, {33, 79}, {33, 80}, {33, 80}, {33, 80}, {33, 80}, {33, 80}, {33, 81}, {33, 81}, {33, 81}, {33, 81}, {33, 82}, {33, 82}, {33, 82}, {33, 82}, {33, 82}, {33, 83}, {33, 83}, {33, 83}, {33, 83}, {33, 83}, {33, 84}, {33, 84}, {33, 84}, {33, 84}, {33, 84}, {33, 85}, {33, 85}, {33, 85}, {34, 85}, {34, 85}, {34, 85}, {34, 85}, {35, 87}, {35, 87}, {35, 87}, {35, 87}, {35, 87}, {36, 87}, {36, 87}, {36, 87}, {36, 87}, {36, 87}, {37, 87}, {37, 87}, {37, 87}, {37, 87}, {37, 87}, {37, 87}, {38, 87}, {38, 88}, {38, 88}, {38, 88}, {38, 88}, {38, 88}, {39, 88}, {39, 88}, {39, 88}, {39, 88}, {39, 88}, {39, 89}, {39, 89}, {39, 89}, {40, 89}, {40, 89}, {40, 89}, {40, 89}, {40, 89}, {40, 89}, {41, 89}, {41, 90}, {41, 90}, {41, 90}, {41, 90}, {42, 90}, {42, 90}, {42, 90}, {42, 90}, {42, 90}, {42, 90}, {43, 90}, {43, 90}, {43, 90}, {43, 90}, {43, 90}, {44, 90}, {44, 90}, {44, 90}, {44, 90}, {45, 90}, {45, 90}, {45, 91}, {45, 91}, {45, 91}, {45, 91}, {46, 91}, {46, 91}, {46, 91}, {46, 91}, {46, 91}, {46, 91}, {47, 91}, {47, 91}, {47, 91}, {47, 91}, {48, 91}, {48, 91}, {48, 91}, {49, 91}, {49, 91}, {50, 91}, {50, 91}, {50, 91}, {50, 90}, {51, 90}, {51, 90}, {51, 90}, {51, 90}, {52, 90}, {52, 90}, {52, 90}, {52, 90}, {52, 90}, {53, 90}, {53, 90}, {53, 90}, {53, 90}, {54, 90}, {54, 90}, {54, 90}, {54, 90}, {55, 90}, {55, 90}, {55, 90}, {55, 90}, {56, 90}, {56, 90}, {57, 90}, {57, 90}, {57, 90}, {57, 90}, {57, 90}, {58, 90}, {58, 90}, {58, 89}, {58, 89}, {58, 89}, {59, 89}, {59, 89}, {59, 89}, {59, 89}, {60, 89}, {60, 89}, {60, 89}, {60, 89}, {60, 89}, {61, 89}, {61, 89}, {61, 89}, {61, 89}, {61, 89}, {62, 89}, {62, 89}, {62, 89}, {62, 89}, {62, 89}, {63, 89}, {63, 89}, {63, 89}, {63, 90}, {64, 90}, {64, 90}, {64, 90}, {64, 90}, {65, 90}, {65, 90}, {65, 90}, {65, 90}, {65, 90}, {66, 90}, {66, 90}, {66, 90}, {67, 90}, {67, 90}, {67, 90}, {67, 90}, {68, 90}, {68, 90}, {68, 90}, {68, 90}, {68, 90}, {69, 90}, {69, 90}, {69, 90}, {70, 90}, {70, 90}, {70, 90}, {71, 90}, {71, 90}, {72, 90}, {72, 90}, {73, 90}, {73, 90}, {74, 90}, {74, 90}, {74, 90}, {75, 90}, {75, 90}, {75, 90}, {76, 90}, {76, 90}, {77, 90}, {77, 90}, {78, 90}, {78, 90}, {79, 90}, {79, 90}, {80, 90}, {80, 89}, {80, 89}, {81, 89}, {81, 89}, {81, 89}, {82, 89}, {82, 89}, {82, 89}, {82, 89}, {82, 89}, {83, 89}, {83, 89}, {83, 89}, {84, 89}, {84, 89}, {84, 89}, {84, 89}, {85, 89}, {85, 89}, {85, 89}, {86, 89}, {86, 89}, {86, 89}, {87, 89}, {87, 89}, {87, 89}, {87, 89}, {88, 89}, {88, 89}, {88, 89}, {89, 89}, {89, 89}, {89, 89}, {89, 89}, {90, 89}, {90, 89}, {91, 89}, {91, 89}, {92, 89}, {92, 89}, {92, 90}, {92, 90}, {93, 90}, {93, 90}, {93, 90}, {93, 90}, {93, 90}, {94, 90}, {94, 90}, {94, 90}, {94, 90}, {94, 90}, {94, 90}, {95, 90}, {95, 90}, {95, 90}, {95, 90}, {96, 90}, {96, 90}, {96, 90}, {96, 90}, {96, 90}, {96, 90}, {97, 90}, {97, 90}, {97, 90}, {97, 90}, {97, 90}, {98, 90}, {98, 90}, {98, 90}, {98, 90}, {98, 90}, {98, 90}, {98, 90}, {98, 89}, {98, 88}, {98, 87}, {98, 86}, {98, 85}, {98, 85}, {98, 84}, {98, 84}, {98, 83}, {98, 83}, {98, 83}, {98, 83}, {98, 82}, {98, 82}, {98, 82}, {98, 81}, {98, 81}, {98, 81}, {98, 81}, {98, 80}, {98, 80}, {98, 80}, {98, 80}, {98, 79}, {98, 79}, {98, 79}, {98, 78}, {98, 78}, {98, 78}, {98, 78}, {98, 78}, {98, 77}, {98, 77}, {98, 77}, {98, 76}, {98, 76}, {98, 76}, {98, 75}, {98, 75}, {98, 74}, {98, 74}, {98, 74}, {98, 73}, {98, 73}, {98, 73}, {98, 73}, {98, 73}, {98, 73}, {98, 72}, {98, 72}, {98, 72}, {98, 71}, {98, 71}, {98, 71}, {98, 71}, {98, 71}, {97, 71}, {97, 71}, {97, 71}, {97, 71}, {96, 71}, {96, 71}, {96, 71}, {96, 71}, {96, 71}, {95, 71}, {95, 71}, {95, 71}, {95, 71}, {95, 71}, {94, 71}, {94, 71}, {94, 71}, {94, 71}, {94, 71}, {93, 71}, {93, 71}, {93, 71}, {93, 70}, {92, 70}, {92, 70}, {92, 70}, {92, 70}, {91, 70}, {91, 70}, {91, 70}, {91, 70}, {90, 70}, {90, 70}, {89, 70}, {89, 70}, {89, 70}, {88, 70}, {88, 70}, {88, 70}, {87, 70}, {87, 70}, {86, 70}, {86, 70}, {86, 70}, {85, 70}, {85, 70}, {84, 70}, {84, 70}, {84, 70}, {83, 70}, {83, 70}, {82, 70}, {82, 70}, {82, 70}, {81, 70}, {81, 70}, {80, 70}, {80, 70}, {80, 70}, {79, 70}, {79, 70}, {79, 70}, {79, 70}, {78, 70}, {78, 70}, {77, 70}, {77, 70}, {76, 70}, {76, 70}, {76, 70}, {76, 70}, {76, 71}, {75, 71}, {75, 71}, {75, 71}, {75, 71}, {74, 71}, {74, 71}, {74, 71}, {73, 71}, {73, 71}, {72, 71}, {72, 71}, {72, 71}, {72, 71}, {72, 71}, {71, 71}, {71, 71}, {71, 71}, {70, 71}, {70, 71}, {70, 71}, {70, 71}, {69, 71}, {69, 71}, {68, 71}, {68, 71}, {67, 71}, {67, 71}, {67, 71}, {67, 71}, {66, 71}, {66, 71}, {65, 71}, {65, 71}, {65, 71}, {64, 71}, {64, 71}, {63, 71}, {63, 71}, {63, 71}, {63, 71}, {62, 71}, {62, 71}, {62, 71}, {61, 71}, {61, 71}, {61, 71}, {60, 71}, {60, 71}, {60, 71}, {60, 71}, {59, 71}, {59, 71}, {59, 71}, {58, 71}, {58, 71}, {58, 71}, {58, 71}, {57, 71}, {57, 71}, {57, 71}, {57, 71}, {56, 71}, {56, 71}, {56, 71}, {56, 71}, {56, 71}, {55, 71}, {55, 71}, {55, 71}, {55, 71}, {55, 71}, {55, 71}, {54, 71}, {54, 71}, {54, 71}, {54, 71}, {53, 71}, {53, 71}, {53, 71}, {53, 71}, {53, 71}, {53, 71}, {53, 71}, {53, 71}, {53, 71}, {53, 70}, {53, 70}, {53, 70}, {53, 69}, {53, 69}, {53, 69}, {53, 69}, {53, 68}, {53, 68}, {53, 67}, {53, 67}, {53, 66}, {53, 66}, {53, 66}, {53, 65}, {53, 65}, {53, 64}, {53, 64}, {53, 64}, {53, 64}, {53, 63}, {53, 63}, {53, 62}, {53, 62}, {53, 62}, {53, 61}, {53, 61}, {53, 61}, {53, 60}, {53, 60}, {53, 60}, {53, 60}, {53, 59}, {53, 59}, {53, 59}, {53, 59}, {53, 59}, {53, 58}, {53, 58}, {53, 58}, {53, 58}, {53, 57}, {53, 57}, {53, 57}, {53, 57}, {53, 56}, {53, 56}, {53, 56}, {53, 55}, {53, 55}, {53, 55}, {53, 54}, {53, 54}, {53, 54}, {53, 53}, {53, 53}, {53, 52}, {53, 52}, {53, 52}, {53, 52}, {53, 52}, {53, 52}, {53, 52}, {53, 51}, {53, 51}, {53, 51}, {53, 51}, {53, 50}, {53, 50}, {53, 49}, {53, 49}, {53, 49}, {53, 49}, {53, 49}, {53, 49}, {54, 49}, {54, 49}, {54, 49}, {54, 49}, {55, 49}, {55, 49}, {55, 49}, {55, 49}, {55, 49}, {55, 49}, {56, 49}, {56, 49}, {56, 49}, {56, 49}, {56, 49}, {57, 49}, {57, 49}, {57, 49}, {57, 50}, {57, 50}, {58, 50}, {58, 50}, {58, 50}, {58, 50}, {59, 50}, {59, 50}, {59, 50}, {59, 50}, {60, 50}, {60, 50}, {60, 50}, {60, 50}, {61, 50}, {61, 50}, {61, 50}, {61, 50}, {62, 50}, {62, 50}, {62, 50}, {62, 50}, {63, 50}, {63, 50}, {63, 50}, {63, 50}, {63, 50}, {64, 50}, {64, 50}, {65, 50}, {65, 50}, {65, 50}, {65, 50}, {66, 50}, {66, 50}, {67, 50}, {67, 50}, {67, 50}, {68, 50}, {68, 50}, {69, 50}, {69, 50}, {69, 50}, {70, 50}, {70, 50}, {70, 50}, {71, 49}, {72, 49}, {72, 49}, {72, 49}, {73, 49}, {73, 49}, {74, 49}, {74, 49}, {74, 49}, {75, 49}, {75, 49}, {75, 49}, {76, 49}, {76, 49}, {77, 49}, {77, 49}, {77, 49}, {77, 48}, {77, 48}, {78, 48}, {78, 48}, {78, 48}, {78, 48}, {79, 48}, {79, 48}, {79, 48}, {79, 48}, {80, 48}, {80, 48}, {80, 48}, {81, 48}, {81, 48}, {81, 48}, {81, 48}, {82, 48}, {82, 48}, {82, 48}, {82, 48}, {83, 48}, {83, 48}, {83, 48}, {84, 48}, {84, 48}, {84, 48}, {85, 48}, {87, 48}};
    
    
    // std::vector<Punto> puntosOriginales = {
    //     {75, 12}, {73, 12}, {71, 13}, {70, 13}, {67, 13}, {66, 14}, {64, 14},
    //     {53, 20}, {51, 21}, {51, 21}, {50, 22}, {48, 24}, {48, 24}, {46, 26},
    //     {42, 31}, {41, 31}, {41, 32}, {40, 32}, {39, 33}, {39, 33}, {38, 34},
    //     {33, 36}, {33, 37}, {32, 37}, {32, 38}, {31, 39}, {31, 39}, {31, 40},
    //     {29, 46}, {29, 47}, {29, 48}, {29, 49}, {29, 51}, {29, 52}, {30, 54},
    //     {32, 65}, {32, 65}, {33, 67}, {33, 68}, {34, 70}, {34, 71}, {34, 71},
    //     {35, 77}, {36, 78}, {36, 80}, {37, 81}, {38, 84}, {38, 85}, {38, 87},
    //     {40, 91}, {40, 91}, {41, 92}, {42, 92}, {43, 93}, {44, 93}, {45, 93},
    //     {55, 94}, {57, 94}, {59, 94}, {60, 93}, {62, 93}, {64, 93}, {66, 93},
    //     {75, 94}, {76, 94}, {77, 94}, {78, 94}, {79, 94}, {79, 94}, {80, 94},
    //     {85, 91}, {86, 91}, {87, 91}, {87, 90}, {89, 89}, {91, 89}, {93, 88},
    //     {100, 83}, {101, 83}, {102, 81}, {102, 81}, {103, 80}, {103, 80},
    //     {106, 72}, {106, 71}, {104, 62}, {104, 61}, {104, 61}, {103, 61},
    //     {103, 61}, {103, 60}
    // };
    // std::vector<Punto> puntosOriginales = {
    //     {75, 12}, {73, 12}, {72, 13}, {71, 13}, {70, 13}, {69, 13}, {67, 13}, {66, 14}, {65, 14}, {64, 14},
    //     {62, 15}, {62, 15}, {61, 16}, {60, 16}, {59, 17}, {57, 18}, {56, 18}, {55, 19}, {54, 20}, {53, 20},
    //     {53, 20}, {51, 21}, {51, 21}, {51, 21}, {50, 22}, {49, 23}, {48, 24}, {48, 24}, {47, 25}, {46, 26},
    //     {46, 27}, {45, 27}, {45, 27}, {45, 28}, {44, 28}, {44, 29}, {43, 29}, {43, 30}, {43, 30}, {42, 30},
    //     {42, 31}, {41, 31}, {41, 31}, {41, 32}, {40, 32}, {40, 32}, {39, 33}, {39, 33}, {38, 33}, {38, 34},
    //     {38, 34}, {37, 34}, {37, 34}, {37, 34}, {36, 35}, {36, 35}, {35, 35}, {35, 35}, {34, 35}, {34, 36},
    //     {33, 36}, {33, 37}, {32, 37}, {32, 37}, {32, 38}, {31, 39}, {31, 39}, {31, 39}, {31, 40}, {31, 40},
    //     {30, 40}, {30, 41}, {30, 41}, {30, 41}, {30, 41}, {30, 42}, {29, 42}, {29, 43}, {29, 44}, {29, 45},
    //     {29, 46}, {29, 47}, {29, 48}, {29, 48}, {29, 49}, {29, 50}, {29, 51}, {29, 52}, {30, 54}, {30, 54},
    //     {30, 56}, {30, 57}, {30, 57}, {31, 58}, {31, 59}, {31, 61}, {31, 62}, {32, 63}, {32, 64}, {32, 64},
    //     {32, 65}, {32, 65}, {33, 66}, {33, 67}, {33, 68}, {33, 69}, {34, 70}, {34, 71}, {34, 71}, {34, 71},
    //     {34, 72}, {34, 72}, {34, 72}, {34, 73}, {35, 73}, {35, 73}, {35, 74}, {35, 74}, {35, 75}, {35, 76},
    //     {35, 77}, {36, 78}, {36, 79}, {36, 80}, {37, 81}, {37, 82}, {38, 84}, {38, 85}, {38, 86}, {38, 87},
    //     {38, 88}, {38, 88}, {38, 88}, {38, 88}, {39, 89}, {39, 89}, {39, 89}, {39, 90}, {39, 90}, {40, 90},
    //     {40, 91}, {40, 91}, {41, 92}, {41, 92}, {42, 92}, {43, 93}, {43, 93}, {44, 93}, {44, 93}, {45, 93},
    //     {45, 93}, {46, 94}, {47, 94}, {48, 94}, {49, 94}, {50, 94}, {51, 94}, {52, 94}, {53, 94}, {54, 94},
    //     {55, 94}, {57, 94}, {58, 94}, {59, 94}, {60, 93}, {62, 93}, {62, 93}, {64, 93}, {65, 93}, {66, 93},
    //     {67, 93}, {68, 93}, {69, 93}, {69, 94}, {70, 94}, {71, 94}, {72, 94}, {72, 94}, {73, 94}, {74, 94},
    //     {75, 94}, {76, 94}, {76, 94}, {77, 94}, {78, 94}, {78, 94}, {79, 94}, {79, 94}, {80, 94}, {80, 94},
    //     {80, 94}, {81, 93}, {81, 93}, {82, 93}, {83, 92}, {83, 92}, {84, 92}, {84, 92}, {85, 91}, {85, 91},
    //     {85, 91}, {86, 91}, {87, 91}, {87, 91}, {87, 90}, {88, 90}, {89, 89}, {91, 89}, {92, 88}, {93, 88},
    //     {94, 88}, {95, 87}, {95, 87}, {96, 87}, {96, 87}, {97, 87}, {97, 86}, {98, 86}, {98, 85}, {99, 84},
    //     {100, 83}, {101, 83}, {101, 82}, {102, 81}, {102, 81}, {103, 80}, {103, 80}, {103, 80}, {104, 79},
    //     {104, 79}, {104, 79}, {104, 78}, {105, 78}, {105, 77}, {105, 76}, {106, 75}, {106, 74}, {106, 73},
    //     {106, 72}, {106, 71}, {105, 65}, {104, 62}, {104, 61}, {104, 61}, {104, 61}, {103, 61}, {103, 61},
    //     {103, 61}, {103, 60}, {103, 60}
    // };


    double epsilon = 1.0;
    auto simpl = rdp(puntosOriginales, epsilon);

    // std::vector<Punto> puntosSuavizados = simplificarTrayectoria(puntosOriginales, 0.5);
    // std::vector<Punto> puntosSuavizados = suavizarBezier(filtrarPuntosCercanos(puntosOriginales, 3), 5);

    // Crear la imagen en negro
    cv::Mat imagen = cv::Mat::zeros(500, 500, CV_8UC3);

    // Dibujar la trayectoria original en rojo
    dibujarTrayectoria(imagen, puntosOriginales, cv::Scalar(0, 0, 255), 2); // Rojo
    std::cout << "p originales: " << puntosOriginales.size() << std::endl;

    // Dibujar la trayectoria suavizada en verde
    dibujarTrayectoria(imagen, simpl, cv::Scalar(0, 255, 0), 2); // Verde
    std::cout << "p originales: " << simpl.size() << std::endl;

    // Mostrar la imagen con ambas trayectorias
    cv::imshow("Trayectoria Original (Rojo) vs Suavizada (Verde)", imagen);
    cv::waitKey(0);

    return 0;
}
